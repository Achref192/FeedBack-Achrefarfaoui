<!-- Section Hero -->
<section class="bg-light py-4 text-center">
  <div class="container">
    <h1 class="display-6 fw-bold">Gestion des Feedbacks</h1>
    <p class="lead text-muted mt-2">
      Partagez votre expérience et consultez les retours de la communauté.<br>
      Votre avis aide à améliorer nos événements.
    </p>
    <div class="mt-3">
      <button class="btn btn-primary btn-lg" (click)="showFeedbackForm()">
        <i class="fas fa-plus me-2"></i>Ajouter un Feedback
      </button>
    </div>
  </div>
</section>

<!-- Section Formulaire d'Ajout -->
<section class="container py-4" *ngIf="isFormVisible">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h5 class="card-title mb-0">
            <i class="fas fa-comment me-2"></i>Nouveau Feedback
          </h5>
        </div>
        <div class="card-body">
          <form (ngSubmit)="submitFeedback()" #feedbackForm="ngForm">
            <div class="mb-3">
              <label for="eventId" class="form-label">Événement</label>
              <select class="form-select" id="eventId" [(ngModel)]="newFeedback.id_event" name="id_event" required>
                <option value="">Sélectionnez un événement</option>
                <option *ngFor="let event of events" [value]="event.id">{{ event.title }}</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="userId" class="form-label">ID Utilisateur</label>
              <input type="number" class="form-control" id="userId"
                     [(ngModel)]="newFeedback.id_user" name="id_user" required>
            </div>

            <div class="mb-3">
              <label for="role" class="form-label">Rôle</label>
              <select class="form-select" id="role" [(ngModel)]="newFeedback.role" name="role" required>
                <option value="">Sélectionnez votre rôle</option>
                <option value="participant">Participant</option>
                <option value="organizer">Organisateur</option>
                <option value="speaker">Intervenant</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="content" class="form-label">Votre Feedback</label>
              <textarea class="form-control" id="content" rows="4"
                        [(ngModel)]="newFeedback.content" name="content"
                        placeholder="Partagez votre expérience..." required></textarea>
            </div>

            <div class="d-flex gap-2">
              <button type="submit" class="btn btn-success" [disabled]="!feedbackForm.valid">
                <i class="fas fa-paper-plane me-2"></i>Envoyer le Feedback
              </button>
              <button type="button" class="btn btn-outline-secondary" (click)="cancelFeedback()">
                <i class="fas fa-times me-2"></i>Annuler
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Section Liste des Feedbacks -->
<section class="container py-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="mb-0">Feedbacks Récents</h3>
        <span class="badge bg-primary">{{ feedbacks.length }} feedback(s)</span>
      </div>

      <!-- Carte de Feedback -->
      <div *ngFor="let feedback of feedbacks" class="card shadow-sm mb-3">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <div>
              <span class="badge bg-secondary me-2">{{ feedback.role }}</span>
              <small class="text-muted">Événement #{{ feedback.id_event }}</small>
            </div>
            <small class="text-muted">{{ feedback.date | date:'dd/MM/yyyy' }}</small>
          </div>

          <p class="card-text">{{ feedback.content }}</p>

          <div class="d-flex justify-content-between align-items-center">
            <small class="text-muted">Utilisateur #{{ feedback.id_user }}</small>
            <button class="btn btn-outline-danger btn-sm" (click)="deleteFeedback(feedback.id)">
              <i class="fas fa-trash me-1"></i>Supprimer
            </button>
          </div>
        </div>
      </div>

      <!-- Message si aucun feedback -->
      <div *ngIf="feedbacks.length === 0" class="text-center py-5">
        <i class="fas fa-comments fa-3x text-muted mb-3"></i>
        <h4 class="text-muted">Aucun feedback pour le moment</h4>
        <p class="text-muted">Soyez le premier à partager votre expérience !</p>
        <button class="btn btn-primary" (click)="showFeedbackForm()">
          <i class="fas fa-plus me-2"></i>Ajouter un Feedback
        </button>
      </div>
    </div>
  </div>
</section>
